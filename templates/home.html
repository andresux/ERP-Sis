{% load static from staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ title }}</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="shortcut icon" href="{{ comp.get_image }}"/>
    <!--CSS-->
    <link rel="stylesheet" href="{% static 'lib/bootstrap-4.3.1/css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'lib/font-awesome-5.11.1/css/all.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'lib/jquery-ui-1.12.1/jquery-ui.css' %}"/>
    <!--JS-->
    <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
    <script src="{% static 'lib/jquery-ui-1.12.1/jquery-ui.min.js' %}"></script>
    {#    <script src="{% static 'lib/bootstrap-4.3.1/js/jquery-3.2.1.slim.min.js' %}"></script>#}
    <script src="{% static 'lib/bootstrap-4.3.1/js/popper.min.js' %}"></script>
    <script src="{% static 'lib/bootstrap-4.3.1/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'lib/bootstrap-4.3.1/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'lib/adminlte-3.0.0/js/adminlte.min.js' %}"></script>
    <!--Template-->
    <link rel="stylesheet" href="{% static 'lib/adminlte-3.0.0/css/adminlte.css' %}"/>
    <!--Stilos-->
    <link rel="stylesheet" href="{% static 'css/style.css' %}?v=1"/>
    <!--Libs-->
    <script src="{% static 'lib/moment/moment.js' %}"></script>
    <script src="{% static 'lib/moment/moment-with-locales.js' %}"></script>
    <script src="{% static 'lib/jquery-confirm-v3.3.4/jquery-confirm.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/jquery-confirm-v3.3.4/jquery-confirm.min.css' %}"/>
    <script src="{% static 'lib/sweetalert2-8.2.4/sweetalert2.all.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/sweetalert2-8.2.4/sweetalert2.css' %}"/>
    <script src="{% static 'lib/jquery-loading-overlay-1.5.3/loadingoverlay.min.js' %}"></script>
    <script src="{% static 'js/functions.js' %}"></script>
    <!--Libs-->
    <script src="{% static 'lib/select2-4.0.10/js/select2.min.js' %}"></script>
    <script src="{% static 'lib/select2-4.0.10/js/i18n/es.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/select2-4.0.10/css/select2.min.css' %}">
    <link rel="stylesheet" href="{% static 'lib/select2-4.0.10/css/select2-bootstrap4.min.css' %}">
    <!--Block head-->
    {% block head %}{% endblock %}
</head>
<!--Block body-->
{% block body %}

{% endblock %}
<!--Javascript-->
<script type="application/javascript">
    var pathname = window.location.pathname, date_joined = moment().format("YYYY-MM-DD");
    $(function () {
        $('.table').on('click', 'img', function () {
            load_image($(this).attr('src'));
        });

        $('[data-toggle="tooltip"]').tooltip();
    });
</script>

<script type="application/javascript">


    function insert_assistance() {
        $.confirm({
            type: 'blue',
            theme: 'modern',
            title: 'Asistencia',
            icon: 'far fa-calendar-check',
            content: 'Â¿Deseas registrar tu asistencia del ' + moment().format("DD-MM-YYYY") + '?',
            columnClass: 'small',
            typeAnimated: true,
            cancelButtonClass: "btn-primary",
            draggable: true,
            dragWindowBorder: false,
            buttons: {
                info: {
                    text: "Si",
                    btnClass: 'btn-primary',
                    action: function () {
                        $.ajax({
                            url: '{% url 'assistance_insert' %}',
                            data: {},
                            method: 'POST',
                            dataType: 'json',
                            success: function (request) {
                                if (!request.hasOwnProperty('error')) {
                                    alert_sweetalert('success', 'Alerta', 'Asistencia registrada correctamente', function () {
                                        location.reload();
                                    }, null, '');
                                    return false;
                                }
                                message_error(request.error);
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                message_error(errorThrown + ' ' + textStatus);
                            }
                        });
                    }
                },
                danger: {
                    text: "No",
                    btnClass: 'btn-red',
                    action: function () {

                    }
                },
            }
        });
    }
    {% if request.user.is_authenticated %}
        {% if not request.user.take_assistance %}
            insert_assistance();
        {% endif %}
    {% endif %}

</script>
</html>